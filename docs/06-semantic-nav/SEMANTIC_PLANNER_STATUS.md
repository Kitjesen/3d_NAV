# semantic_planner æ¨¡å—ç°çŠ¶æŠ¥å‘Š

**æ£€æŸ¥æ—¥æœŸ**: 2026-02-15
**è·¯å¾„**: D:\robot\code\3dnav\3d_NAV\src\semantic_planner

---

## ğŸ“Š æ¨¡å—æ¦‚è§ˆ

### ç›®å½•ç»“æ„
```
semantic_planner/
â”œâ”€â”€ semantic_planner/              # æ ¸å¿ƒæ¨¡å—
â”‚   â”œâ”€â”€ goal_resolver.py           720è¡Œ âœ… å·²å‡çº§
â”‚   â”œâ”€â”€ planner_node.py            940è¡Œ âœ… å·²å®ç°
â”‚   â”œâ”€â”€ frontier_scorer.py         410è¡Œ âœ… å·²å®ç°
â”‚   â”œâ”€â”€ topological_memory.py      397è¡Œ âœ… å·²å®ç°
â”‚   â”œâ”€â”€ task_decomposer.py         357è¡Œ âœ… å·²å®ç°
â”‚   â”œâ”€â”€ llm_client.py              353è¡Œ âœ… å·²å®ç°
â”‚   â”œâ”€â”€ chinese_tokenizer.py       294è¡Œ âœ… å·²å®Œæˆ
â”‚   â”œâ”€â”€ prompt_templates.py        277è¡Œ âœ… å·²å®ç°
â”‚   â””â”€â”€ action_executor.py         267è¡Œ âœ… å·²å®ç°
â”œâ”€â”€ test/                          # æµ‹è¯•å¥—ä»¶
â”‚   â”œâ”€â”€ test_fast_resolve.py       290è¡Œ âœ…
â”‚   â”œâ”€â”€ test_goal_resolver.py      240è¡Œ âœ…
â”‚   â”œâ”€â”€ test_task_decomposer.py    215è¡Œ âœ…
â”‚   â”œâ”€â”€ test_topological_memory.py 190è¡Œ âœ…
â”‚   â”œâ”€â”€ test_frontier_scorer.py    180è¡Œ âœ…
â”‚   â””â”€â”€ test_action_executor.py    150è¡Œ âœ…
â””â”€â”€ setup.py, package.xml          ROS2åŒ…é…ç½®
```

**æ€»ä»£ç é‡**: ~4016è¡Œæ ¸å¿ƒä»£ç  + ~1153è¡Œæµ‹è¯•ä»£ç 

---

## âœ… å·²å®Œæˆçš„æ ¸å¿ƒæ¨¡å—

### 1. ç›®æ ‡è§£æå™¨ (720è¡Œ) â­æ ¸å¿ƒ
**æ–‡ä»¶**: `goal_resolver.py`

**å®ç°å†…å®¹**:
- âœ… Fast-SlowåŒè¿›ç¨‹æ¶æ„ï¼ˆVLingNav 2026ï¼‰
- âœ… Fast Path: åœºæ™¯å›¾ç›´æ¥åŒ¹é…ï¼ˆ~10msï¼Œæ— LLMè°ƒç”¨ï¼‰
- âœ… Slow Path: ESCAé€‰æ‹©æ€§Grounding + LLMæ¨ç†
- âœ… å¤šæºç½®ä¿¡åº¦èåˆï¼ˆ4ä¸ªæ¥æºï¼‰
- âœ… ä¸­æ–‡åˆ†è¯é›†æˆï¼ˆjiebaï¼‰

**å‚è€ƒè®ºæ–‡**:
- VLingNav (arXiv 2601.08665, 2026) - Fast-SlowåŒè¿›ç¨‹
- ESCA/SGCLIP (NeurIPS 2025) - é€‰æ‹©æ€§Grounding
- OmniNav (ICLR 2026) - Fast-Slowç³»ç»Ÿ
- AdaNav (ICLR 2026) - ä¸ç¡®å®šæ€§è‡ªé€‚åº”

**ç½®ä¿¡åº¦èåˆæƒé‡**:
```python
æ ‡ç­¾åŒ¹é…:     35%
CLIPç›¸ä¼¼åº¦:   35%
æ£€æµ‹å™¨ç½®ä¿¡åº¦: 15%
ç©ºé—´å…³ç³»:     15%
```

**æ€§èƒ½ç›®æ ‡**:
- Fast Pathå“åº”: <200ms
- Fast Pathå‘½ä¸­ç‡: 70%+
- APIè´¹ç”¨é™ä½: 90%

---

### 2. è§„åˆ’èŠ‚ç‚¹ (940è¡Œ) â­æ ¸å¿ƒ
**æ–‡ä»¶**: `planner_node.py`

**å®ç°å†…å®¹**:
- âœ… ROS2èŠ‚ç‚¹å®ç°
- âœ… å®Œæ•´çš„çŠ¶æ€æœº
- âœ… å­ç›®æ ‡ç®¡ç†
- âœ… åœºæ™¯å›¾è®¢é˜…
- âœ… å¯¼èˆªæŒ‡ä»¤å‘å¸ƒ

**è®¢é˜…è¯é¢˜**:
- `/scene_graph` - åœºæ™¯å›¾JSON
- `/odometry` - æœºå™¨äººä½å§¿
- `/occupancy_grid` - å æ®æ …æ ¼åœ°å›¾

**å‘å¸ƒè¯é¢˜**:
- `/nav/goal` - å¯¼èˆªç›®æ ‡
- `/nav/semantic/status` - è¯­ä¹‰å¯¼èˆªçŠ¶æ€

**æœåŠ¡**:
- `/nav/semantic/execute` - æ‰§è¡Œè¯­ä¹‰æŒ‡ä»¤

---

### 3. Frontierè¯„åˆ†å™¨ (410è¡Œ)
**æ–‡ä»¶**: `frontier_scorer.py`

**å®ç°å†…å®¹**:
- âœ… MTU3Dç»Ÿä¸€Grounding + Frontieré€‰æ‹©
- âœ… Grounding Potentialè®¡ç®—
- âœ… å¤šå› ç´ è¯„åˆ†èåˆ
- âœ… æ–¹å‘æ ‡ç­¾ç”Ÿæˆ

**å‚è€ƒè®ºæ–‡**:
- MTU3D (ICCV 2025) - Move to Understand
- OpenFrontier (2025) - FrontierNet + VLM
- VLFM (2023) - Visual-Language Frontier Map

**è¯„åˆ†å› ç´ **:
- è·ç¦»å› ç´ 
- æ–°é¢–åº¦å› ç´ 
- è¯­è¨€ç›¸å…³æ€§
- GroundingåŠ¿èƒ½ï¼ˆæ–°å¢ï¼‰

---

### 4. æ‹“æ‰‘è®°å¿† (397è¡Œ)
**æ–‡ä»¶**: `topological_memory.py`

**å®ç°å†…å®¹**:
- âœ… æ‹“æ‰‘å›¾èŠ‚ç‚¹ç®¡ç†
- âœ… å…³é”®å¸§å­˜å‚¨
- âœ… CLIPç‰¹å¾åŒ¹é…
- âœ… è®¿é—®å†å²è·Ÿè¸ª

**å‚è€ƒè®ºæ–‡**:
- VLMnav (2024) - æ‹“æ‰‘å›¾ + VLMé€‰æ‹©
- L3MVN (ICRA 2024) - Language-guidedæ‹“æ‰‘å›¾
- CLIP-Nav (2023) - CLIPç‰¹å¾æ‹“æ‰‘å›¾

**æ ¸å¿ƒåŠŸèƒ½**:
- ä½ç½®è®°å½•å’Œå»é‡
- åœºæ™¯å¿«ç…§å­˜å‚¨
- å›æº¯è·¯å¾„æŸ¥æ‰¾
- æœªæ¢ç´¢åŒºåŸŸè¯†åˆ«

---

### 5. ä»»åŠ¡åˆ†è§£å™¨ (357è¡Œ)
**æ–‡ä»¶**: `task_decomposer.py`

**å®ç°å†…å®¹**:
- âœ… å¤æ‚æŒ‡ä»¤åˆ†è§£
- âœ… å­ç›®æ ‡åºåˆ—ç”Ÿæˆ
- âœ… è§„åˆ™åˆ†è§£ + LLMåˆ†è§£
- âœ… å­ç›®æ ‡çŠ¶æ€ç®¡ç†

**å‚è€ƒè®ºæ–‡**:
- SayCan (Google, 2022) - LLMåˆ†è§£ + å¯è¡Œæ€§è¯„åˆ†
- Inner Monologue (2022) - Chain-of-thoughtåˆ†è§£
- SG-Nav (NeurIPS 2024) - å±‚æ¬¡åœºæ™¯å›¾ + å­ç›®æ ‡è§„åˆ’

**å­ç›®æ ‡åŠ¨ä½œç±»å‹**:
- NAVIGATE - å¯¼èˆªåˆ°åŒºåŸŸ
- FIND - æœç´¢ç›®æ ‡
- APPROACH - æ¥è¿‘ç›®æ ‡
- VERIFY - éªŒè¯ç›®æ ‡
- LOOK_AROUND - åŸåœ°æ‰«æ
- EXPLORE - æ¢ç´¢æœªçŸ¥
- BACKTRACK - å›é€€

---

### 6. LLMå®¢æˆ·ç«¯ (353è¡Œ)
**æ–‡ä»¶**: `llm_client.py`

**å®ç°å†…å®¹**:
- âœ… å¤šåç«¯æ”¯æŒï¼ˆOpenAI/Claude/Qwenï¼‰
- âœ… ä¸»å¤‡åˆ‡æ¢å®¹é”™
- âœ… é‡è¯•æœºåˆ¶
- âœ… è¶…æ—¶æ§åˆ¶
- âœ… æµå¼å“åº”æ”¯æŒ

**æ”¯æŒçš„LLM**:
- GPT-4o (OpenAI)
- Claude 3.5 Sonnet (Anthropic)
- Qwen-Max (é˜¿é‡Œäº‘)

---

### 7. åŠ¨ä½œæ‰§è¡Œå™¨ (267è¡Œ)
**æ–‡ä»¶**: `action_executor.py`

**å®ç°å†…å®¹**:
- âœ… 6ç§åŠ¨ä½œåŸè¯­ï¼ˆLOVON 2024ï¼‰
- âœ… åŠ¨ä½œçŠ¶æ€ç®¡ç†
- âœ… è¶…æ—¶å’Œå¤±è´¥å¤„ç†
- âœ… ç»Ÿä¸€å‘½ä»¤æ¥å£

**å‚è€ƒè®ºæ–‡**:
- LOVON (2024) - 6ç§åŠ¨ä½œåŸè¯­
- SayCan (2022) - åŠ¨ä½œå¯è¡Œæ€§è¯„ä¼°
- Inner Monologue (2022) - æ‰§è¡Œåé¦ˆé‡è§„åˆ’

---

### 8. ä¸­æ–‡åˆ†è¯å™¨ (294è¡Œ) âœ… P0å®Œæˆ
**æ–‡ä»¶**: `chinese_tokenizer.py`

**å®ç°å†…å®¹**:
- âœ… jiebaç²¾ç¡®åˆ†è¯
- âœ… è‡ªå®šä¹‰æœºå™¨äººè¯æ±‡ï¼ˆ30+è¯ï¼‰
- âœ… æ™ºèƒ½å›é€€æœºåˆ¶
- âœ… å…³é”®è¯æå–
- âœ… åè¯çŸ­è¯­æå–

**æ€§èƒ½æå‡**:
- åˆ†è¯å‡†ç¡®ç‡: +30-50%
- Fast Pathå‘½ä¸­ç‡é¢„è®¡: +10-15%

---

### 9. æç¤ºè¯æ¨¡æ¿ (277è¡Œ)
**æ–‡ä»¶**: `prompt_templates.py`

**å®ç°å†…å®¹**:
- âœ… ç›®æ ‡è§£ææç¤ºè¯
- âœ… æ¢ç´¢å†³ç­–æç¤ºè¯
- âœ… è§†è§‰Groundingæç¤ºè¯
- âœ… ä»»åŠ¡åˆ†è§£æç¤ºè¯

---

## ğŸ§ª æµ‹è¯•è¦†ç›–

### å·²æœ‰æµ‹è¯• (1153è¡Œ)
- âœ… `test_fast_resolve.py` (290è¡Œ) - Fast Pathæµ‹è¯•
- âœ… `test_goal_resolver.py` (240è¡Œ) - ç›®æ ‡è§£ææµ‹è¯•
- âœ… `test_task_decomposer.py` (215è¡Œ) - ä»»åŠ¡åˆ†è§£æµ‹è¯•
- âœ… `test_topological_memory.py` (190è¡Œ) - æ‹“æ‰‘è®°å¿†æµ‹è¯•
- âœ… `test_frontier_scorer.py` (180è¡Œ) - Frontierè¯„åˆ†æµ‹è¯•
- âœ… `test_action_executor.py` (150è¡Œ) - åŠ¨ä½œæ‰§è¡Œæµ‹è¯•

**æµ‹è¯•è¦†ç›–ç‡**: è‰¯å¥½ï¼ˆ6ä¸ªæ ¸å¿ƒæ¨¡å—éƒ½æœ‰æµ‹è¯•ï¼‰

---

## ğŸ“ˆ æ ¸å¿ƒæŠ€æœ¯å®ç°

### 1. Fast-SlowåŒè¿›ç¨‹æ¶æ„
```python
# Fast Path (70%åœºæ™¯, ~10ms)
if fused_confidence > 0.75:
    return fast_path_result

# Slow Path (30%åœºæ™¯, ~2s)
filtered_graph = esca_filter(scene_graph)
return llm_resolve(filtered_graph)
```

### 2. ESCAé€‰æ‹©æ€§Grounding
```
200ä¸ªç‰©ä½“ â†’ å…³é”®è¯åŒ¹é… â†’ 1-hopå…³ç³»æ‰©å±• â†’ åŒºåŸŸæ‰©å±• â†’ 15ä¸ªç‰©ä½“
å‡å°‘90% tokensï¼Œé™ä½APIè´¹ç”¨
```

### 3. MTU3D Frontierè¯„åˆ†
```python
score = (
    distance_factor * 0.3 +
    novelty_factor * 0.3 +
    language_relevance * 0.2 +
    grounding_potential * 0.2  # æ–°å¢
)
```

---

## ğŸ”„ ä¸æ–‡æ¡£å¯¹åº”å…³ç³»

æ ¹æ® `docs/06-semantic-nav/UPGRADE_PLAN.md`:

| ä»»åŠ¡ | æ¨¡å— | çŠ¶æ€ |
|------|------|------|
| ä»»åŠ¡#4 | ç›®æ ‡è§£æå™¨ | âœ… å·²å‡çº§ |
| ä»»åŠ¡#5 | Frontierè¯„åˆ†å™¨ | âœ… å·²å®ç° |
| ä»»åŠ¡#6 | æ‹“æ‰‘è®°å¿† | âœ… å·²å®ç° |
| ä»»åŠ¡#7 | ä»»åŠ¡åˆ†è§£å™¨ | âœ… å·²å®ç° |
| ä»»åŠ¡#8 | åŠ¨ä½œæ‰§è¡Œå™¨ | âœ… å·²å®ç° |
| ä»»åŠ¡#9 | LLMå®¢æˆ·ç«¯ | âœ… å·²å®ç° |
| ä»»åŠ¡#11 | ä¸­æ–‡åˆ†è¯ | âœ… å·²å®Œæˆ |

---

## ğŸ’¡ æ€»ç»“

**semantic_planner æ¨¡å—ç°çŠ¶**:
- âœ… æ‰€æœ‰æ ¸å¿ƒæ¨¡å—å·²å®ç°
- âœ… 7ä¸ªå…³é”®æ¨¡å—å·²å‡çº§åˆ°è®ºæ–‡çº§
- âœ… å®Œæ•´çš„æµ‹è¯•è¦†ç›–ï¼ˆ6ä¸ªæµ‹è¯•æ–‡ä»¶ï¼‰
- âœ… Fast-SlowåŒè¿›ç¨‹æ¶æ„å®Œæ•´
- âœ… ESCAé€‰æ‹©æ€§Groundingå·²å®ç°
- âœ… MTU3D Frontierè¯„åˆ†å·²å®ç°

**ä»£ç è´¨é‡**:
- æ¸…æ™°çš„æ¨¡å—åˆ’åˆ†
- å®Œæ•´çš„æ–‡æ¡£æ³¨é‡Š
- è®ºæ–‡å¼•ç”¨è¯¦ç»†
- æµ‹è¯•è¦†ç›–è‰¯å¥½

**æ€§èƒ½é¢„æœŸ**:
- Fast Pathå“åº”: <200ms
- Fast Pathå‘½ä¸­ç‡: 70%+
- APIè´¹ç”¨é™ä½: 90%
- ç«¯åˆ°ç«¯æˆåŠŸç‡: >75%

**ä¸‹ä¸€æ­¥å»ºè®®**:
1. ç«¯åˆ°ç«¯é›†æˆæµ‹è¯•
2. å®é™…åœºæ™¯éªŒè¯
3. æ€§èƒ½è°ƒä¼˜

---

**æœ€åæ›´æ–°**: 2026-02-15
