# ═══════════════════════════════════════════════════════════
# HSG-Nav Ablation 实验配置
#
# 5 组 ablation + 1 Full baseline
# 每组通过参数覆盖禁用特定创新点
#
# 用法:
#   python3 eval_runner.py --ablation full          # 完整系统
#   python3 eval_runner.py --ablation wo_scene_graph
#   python3 eval_runner.py --ablation wo_hierarchy
#   python3 eval_runner.py --ablation wo_reperception
#   python3 eval_runner.py --ablation wo_closed_loop
#   python3 eval_runner.py --ablation wo_exploration
# ═══════════════════════════════════════════════════════════

# ── Full HSG-Nav (基准线) ──
full:
  description: "完整 HSG-Nav 系统 — 所有创新点启用"
  validates: "baseline"
  perception:
    scene_graph.enable: true
    clip.enable: true
    room_naming.llm_enable: true
  planner:
    exploration.enable: true
    exploration.strategy: "sg_nav"
    exploration.sgnav.use_llm_reasoning: true
    exploration.sgnav.arrival_reperception: true
    exploration.sgnav.continuous_reperception: true
    exploration.frontier_vision_weight: 0.15
    goal_resolution.replan_on_failure: true

# ── w/o SceneGraph (纯 CLIP 匹配, 类似 CoW) ──
wo_scene_graph:
  description: "禁用场景图, 仅用 CLIP 特征直接匹配 — 验证场景图的价值"
  validates: "创新1 (在线层次场景图)"
  perception:
    scene_graph.enable: false
    clip.enable: true
    room_naming.llm_enable: false
  planner:
    exploration.enable: true
    exploration.strategy: "frontier"
    exploration.sgnav.use_llm_reasoning: false
    exploration.sgnav.arrival_reperception: false
    exploration.sgnav.continuous_reperception: false
    exploration.frontier_vision_weight: 0.0
    goal_resolution.replan_on_failure: true

# ── w/o Hierarchy (扁平场景图, 无 Room/Group) ──
wo_hierarchy:
  description: "使用扁平场景图 (仅 objects + relations), 无 Room/Group 层次 — 验证层次推理的价值"
  validates: "创新1+2 (层次结构 + 层次 CoT)"
  perception:
    scene_graph.enable: true
    clip.enable: true
    room_naming.llm_enable: false
  planner:
    exploration.enable: true
    exploration.strategy: "frontier"
    exploration.sgnav.use_llm_reasoning: false
    exploration.sgnav.arrival_reperception: true
    exploration.sgnav.continuous_reperception: false
    exploration.frontier_vision_weight: 0.0
    goal_resolution.replan_on_failure: true
  notes: |
    实现方式: 在 planner 中将 scene_graph JSON 的 rooms/groups/hierarchy_edges
    字段置空后再传入 LLM, 强制使用 flat object list 推理。
    planner_node._latest_scene_graph 需被过滤为 flat 格式。

# ── w/o RePerception (关闭到达/连续重检测) ──
wo_reperception:
  description: "禁用到达后验证和连续 Re-perception — 验证 Re-perception 的价值"
  validates: "创新3 (Re-perception + 动态场景适应)"
  perception:
    scene_graph.enable: true
    clip.enable: true
    room_naming.llm_enable: true
  planner:
    exploration.enable: true
    exploration.strategy: "sg_nav"
    exploration.sgnav.use_llm_reasoning: true
    exploration.sgnav.arrival_reperception: false
    exploration.sgnav.continuous_reperception: false
    exploration.frontier_vision_weight: 0.15
    goal_resolution.replan_on_failure: true

# ── w/o ClosedLoop (关闭执行反馈 + 重规划) ──
wo_closed_loop:
  description: "禁用闭环执行反馈 (execution_context + replan) — 验证闭环反馈的价值"
  validates: "创新2 (多步 + 闭环执行反馈)"
  perception:
    scene_graph.enable: true
    clip.enable: true
    room_naming.llm_enable: true
  planner:
    exploration.enable: true
    exploration.strategy: "sg_nav"
    exploration.sgnav.use_llm_reasoning: true
    exploration.sgnav.arrival_reperception: true
    exploration.sgnav.continuous_reperception: true
    exploration.frontier_vision_weight: 0.15
    goal_resolution.replan_on_failure: false
  notes: |
    实现方式: 同时在 planner_node 中清空 _execution_context (不累积),
    禁用 _llm_replan。需修改 _subgoal_completed 不写入 context。

# ── w/o Exploration (仅匹配已知场景图, 不做 frontier 探索) ──
wo_exploration:
  description: "禁用 frontier 探索 — 如果目标不在场景图中直接失败 — 验证探索能力的价值"
  validates: "创新3 (探索 + Re-perception)"
  perception:
    scene_graph.enable: true
    clip.enable: true
    room_naming.llm_enable: true
  planner:
    exploration.enable: false
    exploration.strategy: "none"
    exploration.sgnav.use_llm_reasoning: true
    exploration.sgnav.arrival_reperception: true
    exploration.sgnav.continuous_reperception: false
    exploration.frontier_vision_weight: 0.0
    goal_resolution.replan_on_failure: true
